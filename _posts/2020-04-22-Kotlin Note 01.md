---
layout: post
title: "Kotlin Note 01"
date: 2020-04-22 10:36:42 +0800
categories: [Android,Kotlin]
tags: Android,Kotlin
comments: 1
toc: true
---

å‚è€ƒ:[ç ä¸Šå¼€å­¦](https://kaixue.io/)

> val ã€Œåªè¯»å˜é‡ã€ var ã€Œå¯å˜å˜é‡ã€

### åŸºæœ¬ç±»å‹æ‹†è£…ç®±
Kotlin é‡Œçš„ Int å’Œ Java é‡Œçš„ int ä»¥åŠ Integer ä¸åŒï¼Œä¸»è¦æ˜¯åœ¨è£…ç®±æ–¹é¢ä¸åŒã€‚
```
1.Java é‡Œçš„ int æ˜¯ unbox çš„ï¼Œè€Œ Integer æ˜¯ box çš„ï¼š

â˜•ï¸
int a = 1;
Integer b = 2; // ğŸ‘ˆä¼šè¢«è‡ªåŠ¨è£…ç®± autoboxing
Java
Kotlin é‡Œï¼ŒInt æ˜¯å¦è£…ç®±æ ¹æ®åœºåˆæ¥å®šï¼š

ğŸï¸
var a: Int = 1 // unbox
var b: Int? = 2 // box
var list: List<Int> = listOf(1, 2) // box


2.Java ä¸­çš„æ•°ç»„å’Œ Kotlin ä¸­çš„æ•°ç»„çš„å†™æ³•ä¹Ÿæœ‰åŒºåˆ«ï¼š

â˜•ï¸
int[] array = new int[] {1, 2};
Java
è€Œåœ¨ Kotlin é‡Œï¼Œä¸Šé¢çš„å†™æ³•æ˜¯è¿™æ ·çš„ï¼š

ğŸï¸
var array: IntArray = intArrayOf(1, 2)
// ğŸ‘†è¿™ç§ä¹Ÿæ˜¯ unbox çš„

```
> Java é‡Œçš„åŸºæœ¬ç±»å‹ï¼Œç±»æ¯”åˆ° Kotlin é‡Œé¢ï¼Œæ¡ä»¶æ»¡è¶³å¦‚ä¸‹ä¹‹ä¸€å°±ä¸è£…ç®±ï¼š

- 1.ä¸å¯ç©ºç±»å‹ã€‚
- 2.ä½¿ç”¨ IntArrayã€FloatArray ç­‰ã€‚


### Kotlin å¤„ç†å¼ºè½¬é”™è¯¯çš„æ–¹å¼
```
ğŸï¸
fun main() {
    var activity: Activity = NewActivity()
    // ğŸ‘‡'(activity as? NewActivity)' ä¹‹åæ˜¯ä¸€ä¸ªå¯ç©ºç±»å‹çš„å¯¹è±¡ï¼Œæ‰€ä»¥ï¼Œéœ€è¦ä½¿ç”¨ '?.' æ¥è°ƒç”¨
    (activity as? NewActivity)?.action()
}
```
> æ€è€ƒ:

1.å­ç±»é‡å†™çˆ¶ç±»çš„ override å‡½æ•°ï¼Œèƒ½å¦ä¿®æ”¹å®ƒçš„å¯è§æ€§ï¼Ÿ
2.ä»¥ä¸‹çš„å†™æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

```
ğŸï¸
activity as? NewActivity
activity as NewActivity?
activity as? NewActivity?
```
ğŸ
```
@Test
   fun test() {
       val str = "hello"
       //str as Context
       //str as? Context
       str as? Context?

       /*
       1.ç›´æ¥æŠ›å¼‚å¸¸ : java.lang.ClassCastException: java.lang.String cannot be cast to android.content.Context
       2.é€šè¿‡
       3.é€šè¿‡

       æ­¤æ—¶ : val str="hello"  -> val str=null
       str as? Context? å’Œ str æ˜¯ç­‰æ•ˆçš„
        */

   }
```
### valè‡ªå®šä¹‰ getter
ä¸è¿‡ val å’Œ final è¿˜æ˜¯æœ‰ä¸€ç‚¹åŒºåˆ«çš„ï¼Œè™½ç„¶ val ä¿®é¥°çš„å˜é‡ä¸èƒ½äºŒæ¬¡èµ‹å€¼ï¼Œä½†å¯ä»¥é€šè¿‡è‡ªå®šä¹‰å˜é‡çš„ getter å‡½æ•°ï¼Œè®©å˜é‡æ¯æ¬¡è¢«è®¿é—®æ—¶ï¼Œè¿”å›åŠ¨æ€è·å–çš„å€¼ï¼š
```
ğŸï¸
ğŸ‘‡
val size: Int
    get() { // ğŸ‘ˆ æ¯æ¬¡è·å– size å€¼æ—¶éƒ½ä¼šæ‰§è¡Œ items.size
        return items.size
    }
```
ä¸è¿‡è¿™ä¸ªå±äº val çš„å¦å¤–ä¸€ç§ç”¨æ³•ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ val è¿˜æ˜¯å¯¹åº”äº Java ä¸­çš„ final ä½¿ç”¨çš„ã€‚

### Kotlin ä¸­çš„ object
- åˆ›å»ºä¸€ä¸ªç±»ï¼Œå¹¶ä¸”åˆ›å»ºä¸€ä¸ªè¿™ä¸ªç±»çš„å¯¹è±¡ã€‚è¿™ä¸ªå°±æ˜¯ object çš„æ„æ€ï¼šå¯¹è±¡ã€‚
- åˆ›å»ºå•ä¾‹ , åªéœ€è¦æŠŠ class æ¢æˆ object å°±å¯ä»¥äº†ã€‚
- object å®ç°çš„å•ä¾‹æ˜¯ä¸€ä¸ªé¥¿æ±‰å¼çš„å•ä¾‹ï¼Œå¹¶ä¸”å®ç°äº†çº¿ç¨‹å®‰å…¨ã€‚
- Java ä¸­çš„é™æ€åˆå§‹åŒ–
```
static{ ... }
ğŸï¸
Java ä¸­çš„é™æ€å˜é‡å’Œæ–¹æ³•ï¼Œåœ¨ Kotlin ä¸­éƒ½æ”¾åœ¨äº† companion object ä¸­ã€‚å› æ­¤ Java ä¸­çš„é™æ€åˆå§‹åŒ–åœ¨ Kotlin ä¸­è‡ªç„¶ä¹Ÿæ˜¯æ”¾åœ¨ companion object ä¸­çš„ï¼Œåƒç±»çš„åˆå§‹åŒ–ä»£ç ä¸€æ ·ï¼Œç”± init å’Œä¸€å¯¹å¤§æ‹¬å·è¡¨ç¤ºï¼š
ğŸï¸
class Sample {
       ğŸ‘‡
    companion object {
         ğŸ‘‡
        init {
            ...
        }
    }
}
```
> é‚£åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œåœ¨ objectã€companion object å’Œ top-level ä¸­è¯¥é€‰æ‹©å“ªä¸€ä¸ªå‘¢ï¼Ÿç®€å•æ¥è¯´æŒ‰ç…§ä¸‹é¢è¿™ä¸¤ä¸ªåŸåˆ™åˆ¤æ–­ï¼š

- å¦‚æœæƒ³å†™å·¥å…·ç±»çš„åŠŸèƒ½ï¼Œç›´æ¥åˆ›å»ºæ–‡ä»¶ï¼Œå†™ top-levelã€Œé¡¶å±‚ã€å‡½æ•°ã€‚
- å¦‚æœéœ€è¦ç»§æ‰¿åˆ«çš„ç±»æˆ–è€…å®ç°æ¥å£ï¼Œå°±ç”¨ object æˆ– companion objectã€‚

### Kotlinå¸¸é‡å’ŒJavaå¸¸é‡çš„åŒºåˆ«
```
å‘ç°ä¸åŒç‚¹æœ‰ï¼š

Kotlin çš„å¸¸é‡å¿…é¡»å£°æ˜åœ¨å¯¹è±¡ï¼ˆåŒ…æ‹¬ä¼´ç”Ÿå¯¹è±¡ï¼‰æˆ–è€…ã€Œtop-level é¡¶å±‚ã€ä¸­ï¼Œå› ä¸ºå¸¸é‡æ˜¯é™æ€çš„ã€‚
Kotlin æ–°å¢äº†ä¿®é¥°å¸¸é‡çš„ const å…³é”®å­—ã€‚
é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€ä¸ªåŒºåˆ«ï¼š

Kotlin ä¸­åªæœ‰åŸºæœ¬ç±»å‹å’Œ String ç±»å‹å¯ä»¥å£°æ˜æˆå¸¸é‡ã€‚
åŸå› æ˜¯ Kotlin ä¸­çš„å¸¸é‡æŒ‡çš„æ˜¯ ã€Œcompile-time constant ç¼–è¯‘æ—¶å¸¸é‡ã€ï¼Œå®ƒçš„æ„æ€æ˜¯ã€Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™å°±çŸ¥é“è¿™ä¸ªä¸œè¥¿åœ¨æ¯ä¸ªè°ƒç”¨å¤„çš„å®é™…å€¼ã€ï¼Œå› æ­¤å¯ä»¥åœ¨ç¼–è¯‘æ—¶ç›´æ¥æŠŠè¿™ä¸ªå€¼ç¡¬ç¼–ç åˆ°ä»£ç é‡Œä½¿ç”¨çš„åœ°æ–¹ã€‚


Java ä¸­çš„å¸¸é‡å¯ä»¥è®¤ä¸ºæ˜¯ã€Œä¼ªå¸¸é‡ã€ï¼Œå› ä¸ºå¯ä»¥é€šè¿‡ä¸Šé¢è¿™ç§æ–¹å¼æ”¹å˜å®ƒå†…éƒ¨çš„å€¼ã€‚è€Œ Kotlin çš„å¸¸é‡å› ä¸ºé™åˆ¶ç±»å‹å¿…é¡»æ˜¯åŸºæœ¬ç±»å‹ï¼Œæ‰€ä»¥ä¸å­˜åœ¨è¿™ç§é—®é¢˜ï¼Œæ›´ç¬¦åˆå¸¸é‡çš„å®šä¹‰ã€‚

```

### Kotlin mutable å‰ç¼€æ³¨æ„é—®é¢˜
```
listOf() åˆ›å»ºä¸å¯å˜çš„ Listï¼ŒmutableListOf() åˆ›å»ºå¯å˜çš„ Listã€‚å¯é€šè¿‡ toMutableList ç”±ä¸å¯å˜è½¬æˆå¯å˜é›†åˆ:
ğŸï¸
val strList = listOf("a", "b", "c")
            ğŸ‘‡
strList.toMutableList()

ğŸ‘‰ toMutable*() è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°å»ºçš„é›†åˆï¼ŒåŸæœ‰çš„é›†åˆè¿˜æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥åªèƒ½å¯¹å‡½æ•°è¿”å›çš„é›†åˆä¿®æ”¹ã€‚
```

### å¯è§æ€§ä¿®é¥°ç¬¦
- public ï¼šå…¬å¼€ï¼Œå¯è§æ€§æœ€å¤§ï¼Œå“ªé‡Œéƒ½å¯ä»¥å¼•ç”¨ã€‚
- privateï¼šç§æœ‰ï¼Œå¯è§æ€§æœ€å°ï¼Œæ ¹æ®å£°æ˜ä½ç½®ä¸åŒå¯åˆ†ä¸ºç±»ä¸­å¯è§å’Œæ–‡ä»¶ä¸­å¯è§ã€‚
- protectedï¼šä¿æŠ¤ï¼Œç›¸å½“äº private + å­ç±»å¯è§ã€‚
- internalï¼šå†…éƒ¨ï¼Œä»…å¯¹ module å†…å¯è§ã€‚

Kotlin ä¸­å¦‚æœä¸å†™å¯è§æ€§ä¿®é¥°ç¬¦ï¼Œå°±è¡¨ç¤ºå…¬å¼€ï¼Œå’Œ Java ä¸­ public ä¿®é¥°ç¬¦å…·æœ‰ç›¸åŒæ•ˆæœã€‚åœ¨ Kotlin ä¸­ public ä¿®é¥°ç¬¦ã€Œå¯ä»¥åŠ ï¼Œä½†æ²¡å¿…è¦ã€ã€‚

> internal è¡¨ç¤ºä¿®é¥°çš„ç±»ã€å‡½æ•°ä»…å¯¹ module å†…å¯è§ï¼Œè¿™é‡Œçš„ module å…·ä½“æŒ‡çš„æ˜¯ä¸€ç»„å…±åŒç¼–è¯‘çš„ kotlin æ–‡ä»¶ï¼Œå¸¸è§çš„å½¢å¼æœ‰ï¼š

- Android Studio é‡Œçš„ module
- Maven project

> private
Java ä¸­çš„ private è¡¨ç¤ºç±»ä¸­å¯è§ï¼Œä½œä¸ºå†…éƒ¨ç±»æ—¶å¯¹å¤–éƒ¨ç±»ã€Œå¯è§ã€ã€‚
Kotlin ä¸­çš„ private è¡¨ç¤ºç±»ä¸­æˆ–æ‰€åœ¨æ–‡ä»¶å†…å¯è§ï¼Œä½œä¸ºå†…éƒ¨ç±»æ—¶å¯¹å¤–éƒ¨ç±»ã€Œä¸å¯è§ã€

ğŸŒ°
```
åœ¨ Java ä¸­ï¼Œå¤–éƒ¨ç±»å¯ä»¥è®¿é—®å†…éƒ¨ç±»çš„ private å˜é‡ï¼š

â˜•ï¸
public class Outter {
    public void method() {
        Inner inner = new Inner();
                            ğŸ‘‡
        int result = inner.number * 2; // success
    }

    private class Inner {
        private int number = 0;
    }
}
Java
åœ¨ Kotlin ä¸­ï¼Œå¤–éƒ¨ç±»ä¸å¯ä»¥è®¿é—®å†…éƒ¨ç±»çš„ private å˜é‡ï¼š

ğŸï¸
class Outter {
    fun method() {
        val inner = Inner()
                            ğŸ‘‡
        val result = inner.number * 2 // compile-error: Cannot access 'number': it is private in 'Inner'
    }

    class Inner {
        private val number = 1
    }
}
```


![å¯¼å›¾](/files/androidhigh/å¯¼å›¾.png)


















































.
